"use strict";$.validator.setDefaults({debug:!0}),$.validator.addMethod("regex",function(e,r,a){return this.optional(r)||new RegExp(a).test(e)},"Valore non valido."),$.validator.addMethod("sequence",function(e,r){var a=e,i=$(r).closest("form"),n=Utils.getFormData(i[0]),t=a.split(/p/i).length-1,o=a.split(/d/i).length-1,s=a.split(/c/i).length-1,l=a.split(/a/i).length-1,d=n.numP,u=n.numD,c=n.numC,g=n.numA,m=[];return t<1||o<1||s<1||l<1?(m.push("Uno o più ruoli non è stato inserito nella sequenza."),!1):d==t&&u==o&&c==s&&g==l||(d!=t&&m.push("Nella sequenza inserita i portieri non corrispondono."),u!=o&&m.push("Nella sequenza inserita i difensori non corrispondono."),c!=s&&m.push("Nella sequenza inserita i centrocampisti non corrispondono."),g!=l&&m.push("Nella sequenza inserita gli attaccanti non corrispondono."),!1)},"La sequenza non è valida, controlla che i caratteri inseriti siano coerenti con le opzioni impostate."),$.validator.addMethod("custom",function(e,r,a){return(0,a.check)(e,$(r).closest("form")[0])},function(e,r){var a=$(r).closest("form");return e.onError(r.value,a[0])}),$.validator.addMethod("filesize",function(e,r,a){return this.optional(r)||r.files[0].size<=a},"La dimensione del file non può essere superiore a {0} bytes."),$.extend(jQuery.validator.messages,{required:"Questo campo è obbligatorio.",remote:"Valore non valido.",email:"Inserisci un indirizzo e-mail valido.",url:"Inserire un url valida.",date:"Inserire una data valida.",dateISO:"Inserire una data valida (ISO).",number:"Inserire una cifra valida.",digits:"Inserire solo numeri.",creditcard:"Inserire un numero di carta valido.",equalTo:"Valore non corrispondente.",accept:"Inserire un valore con estensione valida.",maxlength:jQuery.validator.format("Inserire un valore che abbia meno di {0} caratteri."),minlength:jQuery.validator.format("Inserire un valore che abbia almeno {0} characters."),rangelength:jQuery.validator.format("Minimo {0}, massimo {1} caratteri."),range:jQuery.validator.format("Inserire un valore tra {0} e {1}."),max:jQuery.validator.format("Inserire un valore minore o uguale a {0}."),min:jQuery.validator.format("Inserire un valore maggiore o uguale a {0}.")});var serviceHeaders={"Content-Type":"application/json;charset=utf-8",app_key:Settings.appKey},Validations={_hash:{},_registrationRules:{username:{rangelength:[6,20],regex:/^[0-9a-zA-Z-_.]*$/,remote:{param:{url:Api.getActionUrl("utente/verificausername"),headers:serviceHeaders,dataFilter:function(e,r){console.log("data:"+e);var a=JSON.parse(e);return a.success&&a.data?"true":"false"}},depends:function(e){var r=e.getAttribute("data-current-value");return console.log("current:"+r+" -> "+e.value),!r||r!=e.value}}},password:{rangelength:[8,20]},privacy:{required:!0},email:{remote:{param:{url:Api.getActionUrl("utente/verificaemail"),headers:serviceHeaders,dataFilter:function(e,r){var a=JSON.parse(e);return a.success&&a.data?"true":"VE04"==a.error_msgs[0].id?'"'+Str.get("error-"+a.error_msgs[0].id)+'"':"false"}},depends:function(e){var r=e.getAttribute("data-current-value");return!r||r!=e.value}}}},_retrievePasswordRules:{email:{required:!0,email:!0,regex:/\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b/i,minlength:6,maxlength:50,remote:{url:Api.getActionUrl("utente/verificaemail"),headers:serviceHeaders,dataFilter:function(e,r){var a=JSON.parse(e);return a.success&&!a.data?"true":JSON.stringify(Str.get("error-info-not-found"))}}},username:{required:!0,rangelength:[4,15],regex:/^[0-9a-zA-Z-_ .$']*$/,remote:{url:Api.getActionUrl("utente/verificausername"),headers:serviceHeaders,dataFilter:function(e,r){var a=JSON.parse(e);return a.success&&!a.data?"true":JSON.stringify(Str.get("error-info-not-found"))}}},start:{required:!0}},_defaultRules:{username:{required:!0,rangelength:[3,25],regex:/^[0-9a-zA-Z@\-_ .$']*$/},password:{required:!0,rangelength:[4,25]},get nuova_password(){return this.password},conferma_nuova_password:{equalTo:"#nuova_password"},email:{required:!0,email:!0,regex:/\b[A-Z0-9._%+\-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b/i,minlength:6,maxlength:100},squadra:{required:!0},provincia:{required:!0},nascita:{required:!0,number:!0,min:(new Date).getFullYear()-100,max:(new Date).getFullYear()-16,rangelength:[4,4]},nome_lega:{regex:/^[0-9a-zA-Z\- ]*$/,required:!0,rangelength:[4,64]},tipo_lega:{required:!0},nome:{required:!0,regex:/^[a-zA-Zàèìòù' ]*$/,rangelength:[2,32]},cognome:{required:!0,regex:/^[a-zA-Zàèìòù' ]*$/,rangelength:[2,32]},cf:{required:!0,regex:/^[A-Z]{6}[0-9]{2}[A-Z][0-9]{2}[A-Z][0-9]{3}[A-Z]$/i},use_conditions:{required:!0},nome_squadra:{required:!0,regex:/^[0-9a-zA-Z\- \.&]*$/,rangelength:[3,64]},presidente:{required:!0,rangelength:[3,32]},accepted_privacy:{required:!0},parole:{required:!0},initialCredits:{min:0,number:!0,required:!0},sequenzaPanchina:{sequence:!0},resetConfirm:{regex:/^resetta$/i,required:!0},removeConfirm:{regex:/^elimina/i,required:!0},coach:{rangelength:[2,32]},nome_competizione:{rangelength:[3,32]}},_defaultMessages:{username:{required:"Inserisci il tuo nome utente",regex:"Solo lettere, numeri e i caratteri - _ . $ '",remote:"Nome utente già in uso"},email:{required:"Inserisci la tua email",remote:"E-mail già in uso",regex:"Inserisci un indirizzo e-mail valido",minlength:"Troppo corto per essere un indirizzo e-mail!",maxlength:"Troppo lungo per essere un indirizzo e-mail!"},password:{required:"Inserisci una password"},get nuova_password(){return this.password},conferma_nuova_password:{equalTo:"Le password non corrispondono"},nascita:{required:"Inserisci il tuo anno di nascita",rangelength:"L'anno deve essere composto da 4 cifre (es.: 1982)",regex:"L'anno deve essere composto da 4 cifre (es.: 1982)",min:"Sei troppo vecchio per giocare a fantacalcio...",max:"Non avevi detto di avere almeno 16 anni?"},provincia:{required:"Seleziona la tua provincia di residenza"},squadra:{required:"Seleziona il nome della tua squadra del cuore"},nome_lega:{required:"Inserisci il nome della tua lega",regex:"Sono consentiti solo lettere, numeri, spazi ed i caratteri '_' e '-' ",remote:"Questo nome è già utilizzato da un'altra lega"},nome_squadra:{required:"Inserisci il nome della tua squadra.",regex:"Sono consentiti solo lettere, numeri, spazi ed i caratteri '-' e '&' "},accepted_privacy:{required:"Devi accettare le condizioni d'uso."},presidente:{required:"Inserisci il nome con cui vuoi apparire agli altri."},cf:{required:"Inserisci il tuo codice fiscale",regex:"Inserisci un codice fiscale valido"},nome:{regex:"E' consentito solo l'uso di lettere e dell'apostrofo"},get cognome(){return this.nome}},_registrationMessages:{username:{regex:"Solo lettere, numeri e i caratteri - _ ."}},register:function(e,r,a,i){var n=this;$(e).not(".validate").each(function(){var t=$(this);t.addClass("validate"),t.validate({debug:!0,ignore:".note-editor *, .form-ignore, :not([name]), :hidden",errorElement:"div",errorClass:"alert alert-danger field-error",errorPlacement:function(e,r){Log.info("Validations.js::errorPlacement: ",e);var a=r.siblings(".error-list");if(a.length||(a=$('<div class="error-list">').insertAfter(r.is('[type="checkbox"]')?r.closest("label"):r.closest(".cell-counters-container").length?r.closest(".cell-counters-container"):r.nextAll().addBack().last()),a.animate({height:0})),r.is('[type="checkbox"]'))e.appendTo(r.closest(".checkbox"));else if(r.parent(".input-group").length)r.parent(".input-group").after(e);else{a.append(e);var i=0;a.find(".field-error").each(function(){i+=$(this).height()}),a.animate({height:i+"px"})}},highlight:function(e,r,a){$(e).closest(".form-group").addClass("has-error"),$(e).closest(".form-group").find(".field-error").remove()},unhighlight:function(e,r,a){$(e).closest(".form-group").removeClass("has-error"),$(e).closest(".form-group").find(".error-list").animate({height:0})},rules:a||n._defaultRules,messages:i||n._defaultMessages,submitHandler:function(a){if(Log.info("Validations.js::register - ON SUBMIT: "+e),r){var i=r(a);if(i&&i.promise){var n=$(a);n.addClass("submitted");var t=n.closest(".loading-box"),o=t.closest(".modal"),s=t.find(".server-messages");Utils.cleanResponse(s);var l=o.data("bs.modal");if(l&&l.options){var d=o.data("bs.modal").options.keyboard,u=o.data("bs.modal").options.backdrop;o.data("bs.modal").options.keyboard=!1,o.data("bs.modal").options.backdrop="static"}t.addClass("loading"),i.always(function(){l&&l.options&&(o.data("bs.modal").options.keyboard=d,o.data("bs.modal").options.backdrop=u),t.removeClass("loading")})}}else a.submit()}}),t.find("[data-key-restrict]").on("keydown",function(e){var r=1==e.key.length?e.key:"§",a=new RegExp(e.currentTarget.getAttribute("data-key-restrict"));e.keyCode>=48&&!r.match(a)&&e.preventDefault()}),t.find("input[type=file]").on("change",function(e){$(e.currentTarget).valid()}),t.validate().resetForm()})},check:function(e){e.toggleClass("valid",e.valid());e.find('[type="submit"]')}};