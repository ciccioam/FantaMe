"use strict";function refreshUrlParams(){location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,e,r){urlParams[e]=r})}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};window.urlParams={},$(window).on("browser.url.change",refreshUrlParams),refreshUrlParams(),function(t){t.fn.reverse=[].reverse,t.fn.serializeObject=function(){var e=this,r={},n={},a={validate:/^[a-zA-Z][a-zA-Z0-9_]*(?:\[(?:\d*|[a-zA-Z0-9_]+)\])*$/,key:/[a-zA-Z0-9_]+|(?=\[\])/g,push:/^$/,fixed:/^\d+$/,named:/^[a-zA-Z0-9_]+$/};return this.build=function(t,e,r){return t[e]=r,t},this.push_counter=function(t){return void 0===n[t]&&(n[t]=0),n[t]++},t.each(t(this).find(":input").not(".form-ignore").serializeArray(),function(){if(this.name=this.name.replace(/\.([^.[]+)/g,"[$1]"),a.validate.test(this.name)){for(var n,i=this.name.match(a.key),o=this.value,s=this.name;void 0!==(n=i.pop());)s=s.replace(new RegExp("\\["+n+"\\]$"),""),n.match(a.push)?o=e.build([],e.push_counter(s),o):n.match(a.fixed)?o=e.build([],n,o):n.match(a.named)&&(o=e.build({},n,o));r=t.extend(!0,r,o)}}),r},t.fn.closestToOffset=function(e){var r,n,a,i,o,s=null,l=e.left,u=e.top;return this.each(function(){var e=t(this);r=e.offset();var c=.5*e.width(),h=.5*e.height(),d=u-h,f=l-c;if(f>=r.left&&f<=r.right&&d>=r.top&&d<=r.bottom)return s=t(this),!1;var g=[[r.left,r.top],[r.right,r.top],[r.left,r.bottom],[r.right,r.bottom]];for(var p in g)a=g[p][0]-f,i=g[p][1]-d,n=Math.sqrt(a*a+i*i),(void 0===o||n<o)&&(o=n,s=t(this))}),s},t.fn.findSelf=function(t){var e=this.find(t);return this.is(t)?e.add(this):e},t.fn.elementsUnderPoint=function(e,r,n){n=n||document.body;var a,i=[],o=100;do{a=document.elementFromPoint(e,r),a!==n?(i.push(a),a.style.pointerEvents="none"):a=!1,o--}while(a&&o);return i.forEach(function(t){return t.style.pointerEvents="all"}),t(i)}}(jQuery);var Str={_lang:"it",get:function(t,e,r){var n="";return"string"==typeof e&&(r=e),n=Labels[Str._lang][t]||r||t||"",e?n.replace(/({([^}]+)})/g,function(t,r,n){return e[n]}):n}},ZEROES="0000000000",Utils={exist:function(t){return void 0!==t&&null!==t&&!isNaN(t)},ifExists:function(t,e){return Utils.exist(t)?t:e},isUndefined:function(t){return void 0===t},getIndex:function(t,e,r){var t=t&&t.findIndex?t:[];return t.findIndex(function(t){return r?t[r]==e:t==e})},thereIs:function(t,e){return Utils.getIndex(t,e)>-1},matchInside:function(t,e){return t=t||[],$.isArray(e)?e.some(function(e){return t.includes(e)}):new RegExp("("+t.join("|")+")","i").test(e)},extendArray:function(t,e){var r=t.length;t.length=e,t=t.fill(t[r-1],r)},sortByKey:function(t,e,r,n){return t.sort(function(t,a){var i=t[e],o=a[e],s=r?-1:1;return i&&o?(n?i-o:String(i).localeCompare(String(o)))*s:i&&!o?1*s:!i&&o?-1*s:0})},filterByKey:function(t,e,r){return t.filter(function(t){return t&&t.hasOwnProperty(e)&&t[e]==r})},hasKey:function(t,e){var r=e.split(".");if(r.length>1){var n,a=t;do{n=r.shift(),a=a[n]}while(a.hasOwnProperty(n)&&r.length);return 0===r.length}return t.hasOwnProperty(e)},key2val:function(t,e){if(!t||!e||!e.split)return null;var r=e.split(".");return r.length>1?r.reduce(function(e,r){var n="string"==typeof e?t[e]:e;return n?n[r]:null}):t[e]},findPropAndSet:function(t,e,r){var n=e.split("."),a=t;n.length>1?n.map(function(t,e){a.hasOwnProperty(t)||(a[t]=e==n.length-1?r:{}),a=a[t]}):t[e]=r},checkObjKey:function(t,e){return e.split(".").reduce(function(t,e){return t&&t[e]},t)},getDeep:function(t,e,r){var n=e.split("."),a=t;do{var i=n.shift(),a=a[i];void 0!==r&&1==n.length&&(a[n.shift()]=r)}while(n.length);return a},escapeKey:function(t){return t&&t.replace(/\./g,"\\.")},escapeCss:function(t){return t&&t.replace(/\//g,"\\/")},createArray:function(t,e,r,n,a){var i=0;t=Number(t),e=Number(e),r=t<e?r>0?r:1:r<0?r:-1;for(var o=Math.ceil((e-t)/r)+1,s=[],l=t;o--;)s.push(l),l+=r,i++;return n&&(s[0]=n+String(s[0])),a&&(s[s.length-1]=a+String(s[s.length-1])),s},wait:function(t){var e=$.Deferred();return setTimeout(function(){e.resolve()},t),e.promise()},pad:function(t,e){return(ZEROES+t).slice(-(e||2))},capitalize:function(t){return String(t).toLowerCase().replace(/\b\w/g,function(t){return t.toUpperCase()})},parseFloat:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return parseFloat(String(t).replace(/,/g,"."),10)}),parseStringBool:function(t){if("string"==typeof t){if("true"==t.toLowerCase())return!0;if("false"==t.toLowerCase())return!1}return t},parseBool:function(t){return("string"!=typeof t||"false"!=t&&"undefined"!=t&&"null"!=t&&"NaN"!=t)&&Boolean(t)},_now:new Date,parseDate:function(t,e,r){if(!t)return null;if(e=e||"DD-MM-YYYY hh:mm",$.isNumeric(t)){var n=new Date;return n.setTime(t),n}var a={};return e.split(/[ T:-]/).map(function(r){a[r]=+t.substr(e.indexOf(r),r.length)}),a.YYYY||(a.YYYY=r?this._now.getUTCFullYear():this._now.getFullYear()),a.MM||(a.MM=r?this._now.getUTCMonth()+1:this._now.getMonth()+1),a.DD||(a.DD=r?this._now.getUTCDate():this._now.getDate()),r?new Date(Date.UTC(a.YYYY||0,a.MM-1||0,a.DD||1,a.hh||0,a.mm||0,a.ss||0)):new Date(a.YYYY||0,a.MM-1||0,a.DD||1,a.hh||0,a.mm||0,a.ss||0)},parseTime:function(t,e,r){var n=t.split(":").map(function(t){return Utils.pad(t)}).join(":");return Utils.parseDate(n,e||"hh:mm",r)},date2secs:function(t,e){var r=Utils.parseDate(t),n=e?0:r.getTimezoneOffset();return Math.floor(r.getTime()/1e3-60*n)},date2millis:function(t,e){var r=Utils.parseDate(t),n=e?0:r.getTimezoneOffset();return Math.floor(r.getTime()-60*n*1e3)},removeTimezone:function(t){var e=t.getTimezoneOffset();return new Date(t.getTime()-60*e*1e3)},MONTHS:["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],formatDate:function(t,e,r){if(Utils.exist(t)){t instanceof Date||(t=new Date(t));return(e||"DD-MM-YYYY hh:mm").replace(/(YYYY|MMM|Mmm\.|MM|DD|dd|mm|hh|ss)/g,function(e){switch(e){case"YYYY":return r?t.getUTCFullYear():t.getFullYear();case"MMM":return Utils.MONTHS[r?t.getUTCMonth():t.getMonth()];case"Mmm.":return Utils.MONTHS[r?t.getUTCMonth():t.getMonth()].substr(0,3)+".";case"MM":return Utils.pad((r?t.getUTCMonth():t.getMonth())+1);case"DD":return Utils.pad(r?t.getUTCDate():t.getDate());case"dd":return Utils.pad(t.getTime()/864e5);case"mm":return Utils.pad(t.getMinutes());case"hh":return Utils.pad(r?t.getUTCHours():t.getHours());case"ss":return Utils.pad(t.getSeconds())}return null})}},formatCountdown:function(t,e,r){if(Utils.exist(t)){t instanceof Date&&(t=t.getTime());var n=!1;r?t<0&&(n=!0,t=-t):t=Math.max(t,0);var a=(e||"hh:mm:ss").replace(/(YYYY|MMM|Mmm\.|MM|DD|dd|mm|hhh|hh|ss|cc|millis)/g,function(e){switch(e){case"dd":return Utils.pad(Math.floor(t/1e3/60/60/24));case"hhh":return Utils.pad(Math.floor(t/1e3/60/60));case"hh":return Utils.pad(Math.floor(t/1e3/60/60)%24);case"mm":return Utils.pad(Math.floor(t/1e3/60)%60);case"ss":return Utils.pad(Math.floor(t/1e3)%60);case"cc":return Utils.pad(Math.floor(t/10)%100);case"millis":return Utils.pad(t%1e3,3)}return null});return(n?"-":"")+a}},is2Pow:function(t){var e=parseFloat(t,10);return e&&0==(e&e-1)},log2:function(t){return Math.log2?Math.log2(t):Math.log(t)*Math.LOG2E},updateObj:function(t,e){if(e)for(var r in t)e.hasOwnProperty(r)&&(t[r]=e[r]);return t},getChanges:function(t,e,r,n){var a=r?r+".":"",i=n||{};for(var o in e)t.hasOwnProperty(o)&&("boolean"==typeof t[o]||"boolean"==typeof e[o]?Utils.parseBool(t[o])!=Utils.parseBool(e[o])&&(i[a+o]="changed value"):"object"==_typeof(t[o])&&null!==t[o]?t[o].hasOwnProperty("length")?JSON.stringify(t[o])!=JSON.stringify(e[o])&&(i[a+o]="changed array"):Utils.getChanges(t[o],e[o],a+o,i):t[o]!=e[o]&&(i[a+o]="changed value"));return i},getFormData:function(t){return(t instanceof $?t:$(t)).serializeObject()},parseEval:function(t){return void 0!==t&&(!!isNaN(Number(t))||Number(t))},extractFileNameFromUrl:function(t){return t.replace(/(.*)[\/\\]([^\/$\\]+)$/gm,"$2")},getUrlAlias:function(){return location.pathname.slice(1).split("/")[0]},getCurrentUrlPage:function(){return(/\/([^\/]+)($|\/\d|\/$)/g.exec(location.pathname)||[])[1]},updateUrlParams:function(t){Utils.changeBrowserUrl(location.origin+location.pathname+(t?"?"+$.param(t):""))},changeBrowserUrl:function(t){window.history&&window.history.pushState&&(window.history.pushState({url:t},t,t),$(window).trigger("browser.url.change",{prev:location.href,next:t}))},_defaultErrorMessage:{key:"000",body:Str.get("error-000"),type:"danger"},_wrapUID:0,wrap:function(t,e,r,n){var a=!1,i=!1,o=!1;$.isPlainObject(t)&&(e=t.data,r=t.onCompleteWrap,n=t.preventAppend,a=t.wrapPersistent,i=t.prepend,o=t.appendInTheBottom,t=t.target);var s="string"==typeof t?$(t):t,l=s instanceof $&&s.length||0;0==l&&Log.info("utils.js::wrap - WARNING TEMPLATE NOT FOUND",t);var u=this;e&&(e.baseUrl=Settings.baseUrl,e._crestsBaseUrl=Settings.crestsBaseUrl,e._shirtsBaseUrl=Settings.shirtsBaseUrl,e._logosBaseUrl=Settings.logosBaseUrl);var c,h;return n&&(h=$([])),l?s.each(function(t){var s=$(this),d=s.parent(),f={w:d[0].style.width,h:d[0].style.height,o:d[0].style.overflow};d.css("height",d.outerHeight()),d.css("width",d.outerWidth()),d.css("overflow","hidden");var g=s.attr("data-wrap-persistent")||a,p=s.attr("data-wrap-unique-uid")||u._wrapUID,m=+s.attr("data-wrap-refresh-delay")||0;s.attr("data-wrap-unique-uid",p);var v=s.html().replace(/\/{{baseurl}}/g,Settings.baseUrl).replace(/\/{{imagesbaseurl}}/g,Settings.imageBaseUrl),_=Handlebars.compile(v);if(c=$(_(e)),c.length>0){c.attr("data-wrap-uid",p);var w=0;if(p&&!g&&!n){var b=$('[data-wrap-uid="'+p+'"]');b&&b[0]&&(w=b[0].scrollTop);var y=+b.attr("data-wrap-remove-delay")||0;m+y>0?(b.addClass("removing"),setTimeout(function(){b.remove()},m+y)):b.remove()}n?h=h.add(c):(i?s.before(c):o?c.appendTo(s.parent()):s.after(c),$.material.init(),UI.initTooltips(),UI.initPopovers(),UI.initToggles(),UI.initCounters(),UI.initCountdowns(),UI.initSameForAllCheck(),UI.initRestricts(),UI.initEditables(),UI.initSortableList(),UI.initChosen(),UI.initDisableCurrentLinks(),UI.initColorPickers(),UI.initDateTimePickers(),UI.initSliders(),UI.initSelectPicker(),UI.initRichTextField(),UI.initLazyLoad(),UI.initRepeatRemove(),UI.initAutoColspan(),UI._checkStikies()),c[0].scrollTop=w,setTimeout(function(){c.addClass("wrapped"),c.find(".server-messages").addClass("wrapped")},1)}d.css("height",f.w),d.css("width",f.h),d.css("overflow",f.o),l--,0===l&&r&&r(u._wrapUID,c),u._wrapUID++}):0===l&&r&&r(u._wrapUID,c||h),n?h:s},replaceContent:function(t,e){var r=t instanceof jQuery?t:$(t),n=e instanceof jQuery?e:$(e);r.css("height",r.outerHeight()),r.css("width",r.outerWidth()),r.css("position","relative"),n.css("position","absolute"),n.fadeOut(0),r.append(n),r.children().not(n).fadeOut(200,function(){$(this).remove()}),r.animate({width:n.outerWidth(!0),height:n.outerHeight(!0)},300,function(){n.css("position",""),r.css("height",""),r.css("width",""),r.css("position",""),n.fadeIn(200)})},getInitials:function(t){return t?t[0].toUpperCase():""},redirect:function(t,e){LocalStorage.set("redirectOrigin",location.href),Log.info("Utils.js::redirect - url: "+t+" ..."),location.origin+"/"+t!=location.href?($("body").addClass("redirect"),window.location.href=t):e&&window.location.reload(!0)},refresh:function(){Log.info("Utils.js::refresh..."),window.location.reload(!0)},registerHandlebarsPartial:function(t,e){var r=$(e);r.length?(Handlebars.registerPartial(t,r.html()),Log.info("Utils.js::registerHandlebarsPartial - REGISTERED PARTIAL "+t)):Log.info("Utils.js::registerHandlebarsPartial - MISSING: "+e)},registerPartial:function(t,e){return Utils.registerHandlebarsPartial(t,e)},loadPartials:function loadPartials(selector,html,onLoad,ignoreUnwrap){var $partials=$(selector||"[data-partial]:not(.loaded)"),pendings=$partials.length;!pendings&&onLoad?onLoad():$partials.each(function(){var $target=$(this);$target.addClass("loading");var url=html||decodeURI($target.attr("data-partial")),defaultHash="#"+($target.attr("data-partial-default-hash")||"404");url=url.replace("/{{baseurl}}",Settings.baseUrl),url=url.replace("/{{htmlFolder}}",Settings.htmlFolder);var hash=(window.location.hash||defaultHash).slice(1);url=url.replace("{{hash}}",hash),Log.info("utils.js::loadPartials - load: "+url);var appendTo=$target.attr("data-append-to");setTimeout(function(){$target.load(url,function(response,status,xhr){pendings--;var $placeholder=$(this);if($placeholder.removeClass("loading").addClass("loaded"),"error"==status)Log.error("utils.js::loadPartials - ERROR: "+url+" - pendings:"+pendings),ignoreUnwrap||$placeholder.remove(),Utils.redirect("/index.html#404?from="+url);else{Log.info("utils.js::loadPartials - loaded: "+url+" - pendings:"+pendings),Utils.replaceTags($placeholder.children());var partialParams=$placeholder.attr("data-params");if(partialParams){var evalued=JSON.stringify(eval(partialParams));Log.info("utils.js::loadPartials - partialParams: "+evalued);var parsed=JSON.parse(evalued);Utils.wrap($placeholder,parsed)}appendTo&&$placeholder.appendTo($(appendTo)),ignoreUnwrap||$placeholder.children().unwrap()}pendings||Utils.loadPartials(null,null,onLoad)})},0)})},replaceTags:function(t){return t.find('[src*="{{"], [href*="{{"]').each(function(){this.src&&(this.src=encodeURI(decodeURI(this.src).replace("/{{imagesbaseurl}}",Settings.imageBaseUrl))),this.href&&(this.href=encodeURI(decodeURI(this.href).replace("/{{baseurl}}",Settings.baseUrl)))}),t},obscureEmail:function(t,e){return e?t.replace(/(.{3})([^@]*)(.+)/,function(t,e,r,n){return e+r.slice(0,3).replace(/./g,"*")+"@***"}):t.replace(/(.{3})([^@]*)(.+)/,function(t,e,r,n){return e+r.replace(/./g,"*")+n})},smoothScroll:function(t,e,r,n,a,i,o){var s;$.isPlainObject(t)&&(e=t.offset,r=t.millis,n=t.fromBottom,a=t.viewportSelector,i=t.animate||!!t.animationCss,s=t.animationCss,o=t.onScrollComplete,t=t.target);var l=null;try{l="string"==typeof t?$(t):t}catch(e){Log.info("utils.js - smoothScroll target error:",t)}if(l&&l.length){var u=$(a||".viewport"),c=parseFloat(e,10)||100,h=u.height()-l.outerHeight(),d=u.scrollTop()+l.offset().top+(n?-h+c:-c);$(document).trigger("utils.smoothscroll.start",{target:l,scroll:d}),u.animate({scrollTop:d},r||500,"easeInOutQuint",function(){o&&o(),i&&Ani.run(l,s||"ani-soft-bounce"),$(document).trigger("utils.smoothscroll.complete",{scrollTarget:l,scroll:d})})}return l},storeScroll:function(t){var e=t||".viewport",r=$(e),n=r.scrollTop();LocalStorage.set("autoscroll",{target:e,scroll:n})},showLoading:function(t,e,r){var n=$("#loadingModal");Utils.wrap(n.find(".handlebars"),{message:t||"",customClass:e||""}),n.modal({show:!0,backdrop:"static",keyboard:!1});var a=function t(e){n.off("shown.bs.modal",t),r&&r(e)};n.on("shown.bs.modal",a)},hideLoading:function(){$("#loadingModal").modal("hide")},parseServerError:function(t,e,r,n){Utils.wrapServerMessage(n||Api.parseServerErrorMessage(t,e),r)},onResponse:function(t,e,r){return r||Utils.cleanResponse(t),function(r){Utils.parseServerError(r,null,t,e)}},cleanResponse:function(t){(t instanceof jQuery?t:$(t)).find(".server-message").length&&Utils.wrapServerMessage("",t)},wrapServerMessage:function(t,e,r){var n=e instanceof jQuery?e:$(e),a="string"==typeof t?{messages:[{type:r||"warning",body:t}]}:{messages:t.length?t:[t]};if(n.length&&n.is(":visible")){var i=n.findSelf(".handlebar-server-response");if(i.length)return void Utils.wrap(i,a);var o=$("#server-response-partial").first();if(o.length){var s=Utils.wrap(o,a,null,!0),l=s.attr("data-wrap-unique-uid")||s.attr("data-wrap-uid"),u=+s.attr("data-wrap-remove-delay");if(l){var c=n.find('[data-wrap-uid="'+l+'"]');u>0?(c.addClass("removing"),setTimeout(function(){c.remove()},u)):c.remove()}return void n.append(s)}}Toasts.parseMessages(a.messages)},facebookConnect:function(t,e){var r=this;Utils.showLoading("In attesa di una risposta da Facebook..."),FBManager.getCurrentUserId()?FBManager.disconnect(function(n){r.onFacebookDisconnect(n,t,e)},function(t){Log.error("edit_profile.js::facebookConnect - ERROR ON FACEBOOK DISCONNECTION..."),Utils.hideLoading(),e&&e(t)}):this.onFacebookDisconnect(null,t,e)},onFacebookDisconnect:function(t,e,r){var n=Globals.userInfo.data.utente;FBManager.connect(function(t){if(Utils.hideLoading(),t)switch(t.status){case"connected":var a=t.authResponse.accessToken,i=(t.authResponse.userID,n.id);Api.connectToFacebook(i,a,function(t){Log.info("utils.js::onFacebookDisconnect - connectToFacebook:",t),t&&t.success?(t.data&&t.data.map&&t.data.map(function(t){Globals.updateUserSocial(t)}),Utils.refreshFacebookInfo(e,r)):r&&r(t)},function(t){r&&r(t)});break;case"not_authorized":default:r&&r(t)}else r&&r()},{scope:Settings.fbScope})},refreshFacebookInfo:function(t,e){if(FBManager.isAlreadyConnected()){FBManager.getCurrentUserId()?FBManager.getMyInfo(function(r){if(!r||r.error)return Log.error("edit_profile.js::refreshFacebookInfo - error:",r),void(e&&e(r));var n=r;n.provider="facebook",FBManager.getMyPicture(180,180,function(r){!r||r.error?(Log.error("edit_profile.js::refreshFacebookInfo - getMyPicture error:",r),e&&e(r)):n.avatar=r.data.url,Globals.updateUserSocial(n),Utils.wrap(".handlebar-facebook-info",Globals.getUserSocial(),t)})}):(Log.info("edit_profile.js::refreshFacebookInfo - L'utente ha in passato collegato l'app a facebook ma non e' loggato in facebook..."),Utils.wrap(".handlebar-facebook-info",{}))}else Utils.wrap(".handlebar-facebook-info",{})},facebookDisconnect:function(t,e){Api.disconnectFromFacebook(Globals.getUserId(),function(r){r&&r.success?(Globals.removeUserSocial("facebook"),t&&t()):e&&e(r)},e)},copyToClipboard:function(t,e){$(t).prepend('<input id="clipboard" class="offscreen" value="'+e+'">'),document.getElementById("clipboard").select();var r=document.execCommand("copy");return Log.info("utils.js::copyToClipboard:"+e),r},shareByWhatsapp:function(t){return Log.info("utils.js::shareByWhatsapp:"+t),window.location.href="whatsapp://send?text="+encodeURIComponent(t)},shareByEmail:function(t,e,r){return Log.info("utils.js::shareByEmail:"+r),window.location.href="mailto:"+(t||"")+"?subject="+encodeURIComponent(e)+"&body="+encodeURIComponent(r)}},Log={_enabled:"true"==String(urlParams.log).toLowerCase(),debug:function(t,e){Log.write(t,"log",e,"debug"==urlParams.log)},info:function(t,e){Log.write(t,"log",e)},warn:function(t,e){Log.info(t,"warn",e)},error:function(t,e){Log.info(t,"error",e)},write:function(t,e,r,n){(n||Log._enabled)&&(void 0!==r?(console.group(t),console[e](r),console.groupEnd()):console[e](t))}},Toasts={_uid:0,_template:null,_wrapper:null,_hash:{},init:function(t,e){this._template=$(t+" "+e),this._template.length&&(this._wrapper=Handlebars.compile(this._template.html()),$(document).on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",".toast.removing",function(t){$(t.currentTarget).remove()}))},parseMessages:function(t,e){var r=this;(t||[]).map(function(t){r.add(t.title,t.body,t.type||e)})},add:function(t,e,r){var n={id:this._uid,title:t||this._getDefaultTitle(r),body:e||"",type:r||"info"},a=this._wrapper(n),i=$(a).insertAfter(this._template),o=this._uid;i.find(".close").click(function(){Toasts.remove(o)}),setTimeout(function(){i.addClass("added")},1),this._hash[this._uid]=i,this._uid++},remove:function(t){var e=this._hash[t];e.css("max-height",$(e[2]).outerHeight(!0)),e.addClass("removing"),delete this._hash[t]},_getDefaultTitle:function(t){return Str.get("toast-title-"+t)}},LocalStorage={_data:null,init:function(){if("undefined"!=typeof Storage){var t=localStorage.getItem(Settings.localStorageId);this._data=t?JSON.parse(t):{}}else Log.error("No Web Storage support!");this.auto()},get:function(t){return this._data[t]},set:function(t,e){null===this._data&&this.init(),this._data[t]=e,this.save()},del:function(t){delete this._data[t],this.save()},save:function(){localStorage.setItem(Settings.localStorageId,JSON.stringify(this._data)),Log.info("LocalStorage - SAVE")},auto:function(){var t=LocalStorage.get("autoscroll");t&&(Log.info("LocalStorage - autoscroll:",t),$(t.target).scrollTop(t.scroll),LocalStorage.del("autoscroll"))}},Draw={colorToHex:function(t){return"#"+((1<<24)+(Math.floor(t._r)<<16)+(Math.floor(t._g)<<8)+Math.floor(t._b)).toString(16).slice(1)},hexToColor:function(t){var e=parseInt(t,16);return{_r:e>>16&255,_g:e>>8&255,_b:255&e}},recolorImg:function(t,e,r){var n=t.naturalWidth||t.width,a=t.naturalHeight||t.height,i=Draw.createCanvas(n,a),o=i.getContext("2d");o.drawImage(t,0,0);for(var s=o.getImageData(0,0,i.width,i.height),l=s.data,u=0,c=l.length;u<c;u+=4){var h=r?(l[u+0]+l[u+1]+l[u+2])/3:255;l[u+0]=e._r*h/255,l[u+1]=e._g*h/255,l[u+2]=e._b*h/255}return o.putImageData(s,0,0),i},drawOnCanvas:function(t,e,r,n,a){var i=t.getContext("2d"),o=i.height||t.height,s=i.width||t.width;return e.map(function(t,e){var l,u=t.naturalHeight||t.height,c=t.naturalWidth||t.width,h=o/u,d=s/c,f=Math.min(h,d),g=a&&("boolean"==typeof a?a:a[e]);r&&r[e]&&(l=Draw.recolorImg(t,r[e],g));var p=n&&("number"==typeof n?n:n[e]),m=f*u+(p||0),v=f*c+(p||0);i.drawImage(l||t,(s-v)/2,(o-m)/2,v,m)}),t},mergeImages:function(t,e){var r=Draw.createCanvas(t.naturalWidth,t.naturalHeight),n=r.getContext("2d");return n.drawImage(t,0,0),n.drawImage(e,0,0),r},extractColor:function(t,e){if(!e)return t;var r=Draw.createCanvas(t.naturalWidth,t.naturalHeight),n=r.getContext("2d");n.drawImage(t,0,0);for(var a=n.getImageData(0,0,t.naturalWidth,t.naturalHeight),i=a.data,o=n.height||r.height,s=n.width||r.width,l=Draw.createCanvas(s,o),u=l.getContext("2d"),c=0,h=i.length;c<h;c+=4){var d=Math.abs(i[c+0]-e._r)+Math.abs(i[c+1]-e._g)+Math.abs(i[c+2]-e._b);d>96?i[c+3]=0:(i[c+0]=e._r,i[c+1]=e._g,i[c+2]=e._b,i[c+3]=(1-d/96)*i[c+3])}return u.putImageData(a,0,0),l},extractChannel:function(t,e,r){r||(r={_r:255,_g:255,_b:255,_a:255});var n=Draw.createCanvas(t.naturalWidth,t.naturalHeight),a=n.getContext("2d");a.drawImage(t,0,0);for(var i=a.getImageData(0,0,t.naturalWidth,t.naturalHeight),o=i.data,s=a.height||n.height,l=a.width||n.width,u=Draw.createCanvas(l,s),c=u.getContext("2d"),h=0,d=o.length;h<d;h+=4){var f=0,g=(o[h+0]+o[h+1]+o[h+2])/3,p=o[h+0]>=128&&o[h+1]>=128&&o[h+2]>=128,m=o[h+0]<128&&o[h+1]<128&&o[h+2]<128;switch(e){case-1:f=g;break;case 0:f=256-g;break;case 1:f=p||m?0:o[h+0];break;case 2:f=p||m?0:o[h+1];break;case 3:f=p||m?0:o[h+2]}o[h+3]=o[h+3]/256*f,o[h+0]=r._r,o[h+1]=r._g,o[h+2]=r._b}return c.putImageData(i,0,0),u},createCanvas:function(t,e,r){var n=document.createElement("canvas");if(n.width=t,n.height=e,r){var a=n.getContext("2d");a.fillStyle=r,a.fillRect(0,0,n.width,n.height)}return n},_emptyCanvas:document.createElement("canvas").toDataURL(),checkCanvasIsEmpty:function(t){return t.toDataURL()==Draw.createCanvas(t.width,t.height).toDataURL()},clearCanvas:function(t){var e=t.getContext("2d");return e.clearRect(0,0,t.width,t.height),e},refreshCircle:function(t,e,r){var n=t.getContext("2d"),a=(e.size-e.lineWidth)/2;r&&Draw.clearDraw(n,e),Draw.aniDraw(n,e,a)},clearDraw:function(t,e){t.rotate(-(-.5+e.rotate/180)*Math.PI),t.translate(-e.size/2,-e.size/2),t.clearRect(0,0,2*e.size,2*e.size),t.translate(e.size/2,e.size/2),t.rotate((-.5+e.rotate/180)*Math.PI)},aniDraw:function(t,e,r,n){n=n||0,e.current=$.easing.easeInOutExpo(null,5*n,e.start||0,Number(e.percent),500),e.current>0&&(Draw.clearDraw(t,e),Draw.drawCircle(t,e.background,e.lineWidth,r,1),Draw.drawCircle(t,e.foreground,e.lineWidth,r,e.current/100)),e.current<e.percent&&setTimeout(function(){Draw.aniDraw(t,e,r,n+1)},10)},drawCircle:function(t,e,r,n,a){a=Math.min(Math.max(0,a||1),1),t.beginPath(),t.arc(0,0,n,0,2*Math.PI*a,!1),t.strokeStyle=e,t.lineCap="round",t.lineWidth=r,t.stroke()},drawOutline:function(t,e,r,n){var a=t.getContext("2d"),i=t.width,o=(t.height,a.getImageData(0,0,t.width,t.height)),s=o.data,l=this._contour(function(t,e){return s[4*(e*i+t)+3]>20});a.beginPath(),a.strokeStyle=r||"#000",a.lineCap="round",a.lineJoin="round",a.lineWidth=e||1,a.moveTo(l[0][0],l[0][1]);for(var u=(l.slice(-1),l.slice(0,1),1);u<l.length;u++){var c=l[u+1],h=l[u-1];if(n&&c&&h){if(this._findAngle(h,c,l[u])>Math.PI/2){var d=(l[u][0]+l[u+1][0])/2,f=(l[u][1]+l[u+1][1])/2;a.quadraticCurveTo(l[u][0],l[u][1],d,f)}else a.lineTo(l[u][0],l[u][1])}else a.lineTo(l[u][0],l[u][1]);a.lineTo(l[u][0],l[u][1])}return a.closePath(),a.stroke(),t},_findAngle:function(t,e,r){var n={x:t[0],y:t[1]},a={x:e[0],y:e[1]},i={x:r[0],y:r[1]},o=Math.sqrt(Math.pow(i.x-n.x,2)+Math.pow(i.y-n.y,2)),s=Math.sqrt(Math.pow(i.x-a.x,2)+Math.pow(i.y-a.y,2)),l=Math.sqrt(Math.pow(a.x-n.x,2)+Math.pow(a.y-n.y,2));return Math.acos((s*s+o*o-l*l)/(2*s*o))},_contour:function(t,e){var r=e||this._d3_geom_contourStart(t),n=[],a=r[0],i=r[1],o=0,s=0,l=NaN,u=NaN,c=0;do{c=0,t(a-1,i-1)&&(c+=1),t(a,i-1)&&(c+=2),t(a-1,i)&&(c+=4),t(a,i)&&(c+=8),6===c?(o=u===-1?-1:1,s=0):9===c?(o=0,s=1===l?-1:1):(o=this._d3_geom_contourDx[c],s=this._d3_geom_contourDy[c]),o!=l&&s!=u&&(n.push([a,i]),l=o,u=s),a+=o,i+=s}while(r[0]!=a||r[1]!=i);return n},_d3_geom_contourDx:[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,NaN],_d3_geom_contourDy:[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,NaN],_d3_geom_contourStart:function(t){for(var e=0,r=0;;){if(t(e,r))return[e,r];0===e?(e=r+1,r=0):(e-=1,r+=1)}}},Paginator={_options:{},_defaultOptions:{container:null,onChangePage:null,itemsPerPage:10,maxPageButtons:10,remote:null,onRemoteResponse:function(t,e){if(t&&t.success&&t.data){return{totals:t.data.Conta}}}},_$container:null,_data:null,_dataLen:0,_pages:0,_curPage:1,_filters:null,_filteredData:null,_sortedBy:null,_asc:null,_customSortFunctions:{},_sortStack:[],_secondarySortHash:{},_lastSortKey:null,init:function(t){$.extend(this._options,this._defaultOptions,t);var e=this._options;this._$container=e.container instanceof jQuery?e.container:$(e.container),this._$container.length&&(this._$container.addClass("paginated"),this._$container.off("click").on("click","[data-paginator]",this.clickHandler))},setData:function(t){this._data=t,this._filteredData=null,this.setDataLen(this._data.length),Log.info("Paginator::setData data length: "+this._data.length+" - pages:"+this._pages)},setDataLen:function(t,e){this._dataLen=t,this._pages=Math.ceil(this._dataLen/this._options.itemsPerPage),e||(this._curPage=1),Log.info("Paginator::setDataLen data length: "+t+" - pages:"+this._pages)},goPage:function(t,e){var r=this._options;Log.info("Paginator::goPage page:"+t),t=Math.max(1,Math.min(t,this._pages)),this._curPage=t,Log.info("\t\t...current page:"+this._curPage);var n=(t-1)*r.itemsPerPage,a=t*r.itemsPerPage,i=this;if(r.remote)return r.remote(t).then(function(n){var a=r.onRemoteResponse(n,t);i.onPageData(a,t,o,e)});var o=this._filteredData||this._data,s=o?o.slice(n,a):null;return this.onPageData(s,t,o,e)},onPageData:function(t,e,r,n){var a=this._options;Log.info("Paginator::onPageData data pages:"+this._pages);var i=this.getPaginationWrapData(e);return a.onChangePage&&a.onChangePage(t,this._curPage,this._pages,t?r.length:this._dataLen,i.pages,n),t},getPaginationWrapData:function(t){for(var e=this._options,r=[],n=0;n<e.maxPageButtons;n++){var a=(t||1)+n-(e.maxPageButtons>>1);a>=1&&a<=this._pages&&r.push({index:a,label:a,current:a==this._curPage})}return Log.info("Paginator::getPaginationWrapData curPage: "+this._curPage+" - buttons:",r),{current:this._curPage,totals:this._pages,items:this._dataLen,pages:r}},sortBy:function(t,e,r){this._sortedBy=t,this._asc=e,this._sortText=r,this._sortStack=this._sortStack.filter(function(e){return e.key!=t}),this._sortStack.unshift({key:t,isAsc:e,isText:r}),this._sortStack.length>3&&(this._sortStack.length=3);var n=this._filteredData||this._data;this._lastSortKey!=t&&(this._lastSortKey=t,this._secondarySortHash={},n&&n[0].hasOwnProperty("id")&&n.map(function(t,e){return Paginator._secondarySortHash[t.id]=e})),n=n.sort(this.stackSorting),this.goPage(1)},stackSorting:function(t,e){var r,n=0;do{var a=0;if(r=Paginator._sortStack[n]){a=Paginator.getSortFunction(r.key,r.isAsc,r.isText)(t,e)}if(n>10)break;n++}while(0==a&&r);return a},getSortFunction:function(t,e,r){return this._customSortFunctions[t]?this._customSortFunctions[t](t,e,r):function(n,a){if(!n.hasOwnProperty(t)||!a.hasOwnProperty(t))return 0;var i=n.hasOwnProperty("id")&&a.hasOwnProperty("id")?Paginator._secondarySortHash[n.id]-Paginator._secondarySortHash[a.id]:parseFloat(n.id)-parseFloat(a.id);return((r?String(n[t]).localeCompare(a[t]):parseFloat(n[t])-parseFloat(a[t]))||i)*(e?-1:1)}},addSortFunctions:function(t,e){this._customSortFunctions[t]=e},setFilters:function(t){this._filters=t},getFilteredData:function(t){t||(t=this._data&&this._data.slice());for(var e=this,r=$.isArray(e._filters)?e._filters:[e._filters],n=t||[],a=0;a<r.length;a++){var i=r[a];n=n.filter(function(t){for(var e in i){if(!i.hasOwnProperty(e))return!0;var r=i[e],n=t[e];if("function"==typeof r)return r(n);if(/>x>/i.test(r)){var a=r.split(/>x>/i);return n>=a[0]&&n<=a[1]}if("boolean"==typeof r)return n==r;if("string"!=typeof r&&"number"!=typeof r||(r=[r]),Utils.matchInside(r,n,!0))return!0}return!1})}return n},applyFilters:function(t){return this._data&&(t&&this.setFilters(t),this._filteredData=this.getFilteredData(),this.setDataLen(this._filteredData.length)),this._sortedBy?this.sortBy(this._sortedBy,this._asc,this._sortText):this.goPage(1)},next:function(t){return this.goPage(this._curPage+1,t)},prev:function(t){return this.goPage(this._curPage-1,t)},first:function(t){return this.goPage(1,t)},last:function(t){return this.goPage(this._pages,t)},refresh:function(t){return this.applyFilters()},getCurPage:function(){return this._curPage},clickHandler:function(t){var e=$(t.target);switch(e.attr("data-paginator")){case"first":Paginator.first(!0);break;case"last":Paginator.last(!0);break;case"next":Paginator.next(!0);break;case"prev":Paginator.prev(!0);break;case"page":Paginator.goPage(e.attr("data-page"),!0)}}},Ani={run:function(t,e,r){t.removeClass(e),t.each(function(t,e){e.offsetWidth});var n=function e(n){t.off("animationend webkitAnimationEnd",e),r&&r()};t.on("animationend webkitAnimationEnd",n),t.addClass(e)},onAddClass:function(t,e,r){console.log("### ADD CLASS... "),t.removeClass(e),t.each(function(t,e){e.offsetWidth});var n=Date.now(),a=setTimeout(function(){console.log("### TIMEOUT START ANI: "+(Date.now()-n)),r&&r()},1e3);t.off("animationstart webkitAnimationStart"),t.on("animationstart webkitAnimationStart",function(){console.log("### START ANI: "+(Date.now()-n)),clearTimeout(a);var e=function e(n){t.off("animationend webkitAnimationEnd",e),r&&r()};t.on("animationend webkitAnimationEnd",e)}),t.addClass(e)},onRemoveClass:function(t,e,r){t.removeClass(e),t.each(function(t,e){e.offsetWidth});var n=function e(n){t.off("animationend webkitAnimationEnd",e),r&&r()};t.on("animationend webkitAnimationEnd",n)}};Handlebars.registerHelper("func",function(t,e,r,n){return t?t(e,r):e}),Handlebars.registerHelper("getProp",function(t,e){return Utils.key2val(t,e)}),Handlebars.registerHelper("whatis",function(t){console.log("whatis:"+t)}),Handlebars.registerHelper("keyToLabel",function(t){return t?t.replace(/__data_[^_]*__/g,"").replace(/_/g," "):""}),Handlebars.registerHelper("min",function(t,e){return Math.min(t,e)}),Handlebars.registerHelper("max",function(t,e){return Math.max(t,e)}),Handlebars.registerHelper("or",function(){return Array.prototype.slice.call(arguments,0,-1).reduce(function(t,e){return t||e},!1)}),Handlebars.registerHelper("and",function(t,e){return Array.prototype.slice.call(arguments,0,-1).reduce(function(t,e){return t&&e},!0)}),Handlebars.registerHelper("not",function(t){return!t}),Handlebars.registerHelper("negate",function(t){return-t}),Handlebars.registerHelper("oneorother",function(t,e,r){return t==e?e:r}),Handlebars.registerHelper("equal",function(){return Array.prototype.slice.call(arguments,0,-1).reduce(function(t,e){return t==e})}),Handlebars.registerHelper("lt",function(t,e){return t<e}),Handlebars.registerHelper("gt",function(t,e){return t>e}),
Handlebars.registerHelper("sum",function(){return Array.prototype.slice.call(arguments,0,-1).reduce(function(t,e){return t+e},0)}),Handlebars.registerHelper("subtract",function(){var t=Array.prototype.slice.call(arguments,0,-1);return t[0]?t.reduce(function(t,e){return t-e}):0}),Handlebars.registerHelper("product",function(){return Array.prototype.slice.call(arguments,0,-1).reduce(function(t,e){return t*e})}),Handlebars.registerHelper("inverse",function(t){return-t}),Handlebars.registerHelper("limit",function(t,e){return t.length>e?t.slice(0,e):t.slice()}),Handlebars.registerHelper("limitif",function(t,e,r){return t&&e.length>r?e.slice(0,r):e.slice()}),Handlebars.registerHelper("repeat",function(t,e){for(var r="",n=0;n<t;++n)r+=e.fn(n);return r}),Handlebars.registerHelper("ifodd",function(t,e){return t%2?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("join",function(t,e){return t?t.join(e.fn(this)):t}),Handlebars.registerHelper("split",function(t,e,r){e&&"/"!=e&&"/"==e[0]&&"/"==e[e.length-1]&&(e=new RegExp(e.slice(1,-1)));var n=t&&t.split?t.split(e):t;return r>=0?n[r]:n}),Handlebars.registerHelper("compare",function(t,e,r,n){var a,i;if(arguments.length<3)throw new Error("Handlerbars Helper 'compare' needs 2 parameters");if(void 0===n&&(n=r,r=e,e="==="),a={"==":function(t,e){return t==e},"===":function(t,e){return t===e},"!=":function(t,e){return t!=e},"!==":function(t,e){return t!==e},"<":function(t,e){return t<e},">":function(t,e){return t>e},"<=":function(t,e){return t<=e},">=":function(t,e){return t>=e},typeof:function t(e,r){return(void 0===e?"undefined":t(e))==r}},!a[e])throw new Error("Handlerbars Helper 'compare' doesn't know the operator "+e);return i=a[e](t,r),i?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("filter",function(t,e,r){return t&&t.filter?t.filter(function(t){return t[e]==r}):[]}),Handlebars.registerHelper("switch",function(t,e){if(!Object.isExtensible(this))return r;this._switch_value_=t,this._switch_break_=!1;var r=e.fn(this);return delete this._switch_value_,delete this._switch_break_,r}),Handlebars.registerHelper("case",function(t,e){var r=Array.prototype.slice.call(arguments),e=r.pop(),n=r;return this._switch_break_||n.indexOf(this._switch_value_)===-1?"":(this._switch_break_=!0,e.hash.break===!1&&(this._switch_break_=!1),e.fn(this))}),Handlebars.registerHelper("default",function(t){if(!this._switch_break_)return t.fn(this)}),Handlebars.registerHelper("ifset",function(t,e,r){return t&&t!=e?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("ifequal",function(t,e,r){return t==e?r.fn(this):r.inverse(this)}),Handlebars.registerHelper("ifexist",function(t,e){return void 0!==t&&null!==t?"object"===(void 0===e?"undefined":_typeof(e))?e.fn(this):t:"object"===(void 0===e?"undefined":_typeof(e))?e.inverse(this):e}),Handlebars.registerHelper("thereis",function(t,e){return Utils.thereIs(e,t)}),Handlebars.registerHelper("isoneof",function(){var t=Array.prototype.slice.call(arguments,0,-1),e=arguments[arguments.length-1],r=t.shift();return Utils.thereIs(t,r)?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("fix",function(t,e){return"number"!=typeof e&&(e=1),parseFloat(t,10).toFixed(e)}),Handlebars.registerHelper("lowercase",function(t){return String(t).toLowerCase()}),Handlebars.registerPartial("server-response",$("#server-response-partial:first()").html()),Handlebars.registerPartial("pagination",$("#pagination-partial").html());