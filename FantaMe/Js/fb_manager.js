"use strict";var FBManager,fbm=FBManager={_checkLoginStateTimeoutId:-1,_initialized:!1,_onInit:null,debug:!1,init:function(o){fbm.log("FBManager::init..."),this._onInit=o,window.fbAsyncInit?fbm.log("FBManager::init - already initialized..."):(window.fbAsyncInit=fbm.onSdkInit,function(o,n,e){var t,a=o.getElementsByTagName(n)[0];o.getElementById(e)||(t=o.createElement(n),t.id=e,t.onerror=function(o){},t.src="//connect.facebook.net/en_US/sdk.js",a.parentNode.insertBefore(t,a))}(document,"script","facebook-jssdk"))},log:function(o,n){fbm.debug&&Log.info(o,n)},onSdkInit:function(){fbm.log("FBManager::onSdkInit..."),FB.init(Settings.fbConfig),fbm.checkLoginState()},onStatusChange:function(o){switch(clearTimeout(fbm._checkLoginStateTimeoutId),Globals.facebookInfo=o,fbm._initialized||(fbm.log("FBManager::onStatusChange - INITIALIZED"),fbm._initialized=!0,$(document).trigger("fg.facebook.initialized"),fbm._onInit&&fbm._onInit()),fbm.log("FBManager::onStatusChange - response: ",o),$(document).trigger("fg.facebook.statuschange"),o.status){case"connected":fbm.log("FBManager::onStatusChange - Logged into your app and Facebook. ");break;case"not_authorized":fbm.log("FBManager::onStatusChange - The person is logged into Facebook, but not your app. ");break;default:fbm.log("FBManager::onStatusChange - The person is not logged into Facebook, so we're not sure if they are logged into this app or not. ")}},onStatusTimeout:function(){fbm.log("FBManager::onStatusTimeout..."),fbm.debug&&alert("fb_manager non ha ricevuto risposta...")},checkLoginState:function(){fbm.log("FBManager::checkLoginState..."),fbm._checkLoginStateTimeoutId=setTimeout(fbm.onStatusTimeout,3e3),FB.getLoginStatus(fbm.onStatusChange)},connect:function(o){fbm.log("FBManager::connect..."),FB.login(function(n){fbm.log("FBManager::connect - login response:",n),fbm.onStatusChange(n),o&&o(n)})},disconnect:function(o){fbm.log("FBManager::disconnect..."),FB.logout(function(n){fbm.log("FBManager::disconnect - logout response:",n),fbm.onStatusChange(n),o&&o(n)})},getMyInfo:function(o){fbm.log("FBManager::getMyInfo..."),FB.api("/me",function(n){fbm.log("FBManager::getMyInfo - response:",n),o&&o(n)})},getMyPicture:function(o,n,e){fbm.log("FBManager::getMyPicture...");var t=o||128,a=n||128,i=fbm.getCurrentUserId();FB.api("/"+i+"/picture?width="+t+"&height="+a+"&redirect=false",function(o){fbm.log("FBManager::getMyPicture - response:",o),e&&e(o)})},getCurrentUserId:function(){return Globals.facebookInfo&&Globals.facebookInfo.status&&"connected"==Globals.facebookInfo.status&&Globals.facebookInfo.authResponse?Globals.facebookInfo.authResponse.userID:null},getCurrentToken:function(){return Globals.facebookInfo&&Globals.facebookInfo.status&&"connected"==Globals.facebookInfo.status&&Globals.facebookInfo.authResponse?Globals.facebookInfo.authResponse.accessToken:null},isAlreadyConnected:function(){return Globals.userSocials&&Globals.userSocials.facebook?Globals.userSocials.facebook.id:null}};